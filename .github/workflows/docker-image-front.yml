- name: Deploy Frontend to VM
        uses: appleboy/ssh-action@v0.1.10
        with:
          host: ${{ secrets.VM_SSH_IP }}
          username: ${{ secrets.VM_SSH_USER }}
          key: ${{ secrets.VM_SSH_KEY }}
          script: |
            # 1. Login to ACR
            docker login myappregistry.azurecr.io -u ${{ secrets.ACR_USERNAME }} -p ${{ secrets.ACR_PASSWORD }}
            
            # 2. Forcefully remove old frontend container
            docker rm -f frontend-app || true
            
            # 3. Pull the new image
            docker pull myappregistry.azurecr.io/frontend-app:latest
            
            # 4. Run the frontend on Port 80
            # This maps the VM's port 80 to Nginx's port 80 inside the container
            docker run -d --name frontend-app -p 80:80 myappregistry.azurecr.io/frontend-app:latest
